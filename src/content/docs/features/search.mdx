---
title: æœç´¢åŠŸèƒ½
description: Pagefind æœç´¢å¼•æ“ä½¿ç”¨æŒ‡å—
---

ShokaX ä¸»é¢˜é›†æˆäº† [Pagefind](https://pagefind.app/) æœç´¢å¼•æ“ï¼Œæä¾›å¿«é€Ÿã€ç¦»çº¿çš„å…¨æ–‡æœç´¢ä½“éªŒã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- **å¿«é€Ÿå“åº”**ï¼šå®¢æˆ·ç«¯æœç´¢ï¼Œæ— éœ€æœåŠ¡å™¨
- **ç¦»çº¿å¯ç”¨**ï¼šæ„å»ºæ—¶ç”Ÿæˆç´¢å¼•ï¼Œæ— éœ€å¤–éƒ¨æœåŠ¡
- **è½»é‡çº§**ï¼šæŒ‰éœ€åŠ è½½ï¼Œé¦–å±ä¸å½±å“æ€§èƒ½
- **è‡ªåŠ¨ç´¢å¼•**ï¼šæ„å»ºæ—¶è‡ªåŠ¨æå–æ–‡ç« å†…å®¹
- **æ˜æš—æ¨¡å¼**ï¼šè‡ªåŠ¨é€‚é…ä¸»é¢˜æ ·å¼

## ä½¿ç”¨æœç´¢

### æ‰“å¼€æœç´¢é¢æ¿

ç‚¹å‡»å¯¼èˆªæ å³ä¸Šè§’çš„ **ğŸ” æœç´¢å›¾æ ‡** å³å¯æ‰“å¼€æœç´¢é¢æ¿ã€‚

**å¿«æ·é”®**ï¼ˆè§„åˆ’ä¸­ï¼‰ï¼š
- `Ctrl + K` æˆ– `Cmd + K`ï¼ˆmacOSï¼‰

### æœç´¢æ–‡ç« 

1. åœ¨æœç´¢æ¡†ä¸­è¾“å…¥å…³é”®è¯
2. å®æ—¶æ˜¾ç¤ºåŒ¹é…ç»“æœ
3. ç‚¹å‡»ä»»æ„ç»“æœè·³è½¬åˆ°å¯¹åº”æ–‡ç« 
4. ç‚¹å‡»å³ä¸‹è§’ **âœ•** å…³é—­æœç´¢é¢æ¿

## å·¥ä½œåŸç†

### ç´¢å¼•ç”Ÿæˆ

åœ¨æ¯æ¬¡ç”Ÿäº§æ„å»ºæ—¶ï¼ŒPagefind ä¼šè‡ªåŠ¨ï¼š

1. æ‰«æ `dist/` ç›®å½•ä¸‹çš„æ‰€æœ‰ HTML æ–‡ä»¶
2. æå–æ ‡è®°ä¸º `data-pagefind-body` çš„å†…å®¹
3. ç”Ÿæˆæœç´¢ç´¢å¼•æ–‡ä»¶ï¼ˆ`pagefind/` ç›®å½•ï¼‰
4. æ„å»ºåˆ†è¯æ•°æ®åº“

**æ„å»ºå‘½ä»¤**ï¼š

```bash
bun run build
```

è¿™ä¸ªå‘½ä»¤æ‰§è¡Œä¸¤æ­¥ï¼š
1. `bun run build:site` - æ„å»º Astro ç«™ç‚¹
2. `bun run build:index` - ç”Ÿæˆ Pagefind ç´¢å¼•

:::tip[è‡ªåŠ¨æ„å»º]
ä½¿ç”¨ `bun run build` ä¼šè‡ªåŠ¨å®Œæˆç´¢å¼•ç”Ÿæˆï¼Œæ— éœ€æ‰‹åŠ¨æ‰§è¡Œ `pagefind` å‘½ä»¤ã€‚
:::

### æ ‡è®°å¯æœç´¢å†…å®¹

ä¸»é¢˜å·²è‡ªåŠ¨ä¸ºæ–‡ç« å†…å®¹æ·»åŠ  `data-pagefind-body` å±æ€§ï¼š

```astro title="src/pages/posts/[...slug].astro"
<div class="body md" itemprop="articleBody" data-pagefind-body>
  <slot />
</div>
```

è¿™æ„å‘³ç€ï¼š
- âœ… æ–‡ç« æ­£æ–‡å†…å®¹ä¼šè¢«ç´¢å¼•
- âŒ å¯¼èˆªæ ã€ä¾§è¾¹æ ã€é¡µè„šç­‰ä¸ä¼šè¢«ç´¢å¼•

### æœç´¢ UI

æœç´¢é¢æ¿ä½¿ç”¨ `@pagefind/default-ui` ç»„ä»¶ï¼Œåœ¨ `SearchPage.svelte` ä¸­åˆå§‹åŒ–ï¼š

```svelte title="src/components/search/SearchPage.svelte"
new PagefindUI({ 
  element: "#pagefind", 
  showSubResults: true  // æ˜¾ç¤ºå­ç»“æœï¼ˆæ ‡é¢˜å±‚çº§ï¼‰
});
```

## è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹å¯æœç´¢èŒƒå›´

å¦‚æœä½ æƒ³è®©å…¶ä»–å†…å®¹ä¹Ÿå¯è¢«æœç´¢ï¼Œæ·»åŠ  `data-pagefind-body` å±æ€§ï¼š

```astro
<div data-pagefind-body>
  <!-- è¿™é‡Œçš„å†…å®¹ä¼šè¢« Pagefind ç´¢å¼• -->
  <p>ä½ çš„å†…å®¹...</p>
</div>
```

**æ’é™¤ç‰¹å®šå†…å®¹**ï¼š

```astro
<div data-pagefind-body>
  <p>è¿™æ®µä¼šè¢«ç´¢å¼•</p>
  <div data-pagefind-ignore>
    è¿™æ®µä¸ä¼šè¢«ç´¢å¼•ï¼ˆä¾‹å¦‚ä»£ç ã€å¼•ç”¨æ¥æºç­‰ï¼‰
  </div>
</div>
```

### è‡ªå®šä¹‰å…ƒæ•°æ®

ä¸ºæœç´¢ç»“æœæ·»åŠ æ›´å¤šä¿¡æ¯ï¼ˆå¦‚æ ‡ç­¾ã€åˆ†ç±»ï¼‰ï¼š

```astro
<article 
  data-pagefind-body
  data-pagefind-meta="category:Frontend, tags:Astro,Svelte"
>
  <!-- æ–‡ç« å†…å®¹ -->
</article>
```

### é…ç½® Pagefind é€‰é¡¹

ç¼–è¾‘ `package.json` ä¿®æ”¹ç´¢å¼•ç”Ÿæˆé€‰é¡¹ï¼š

```json title="package.json"
{
  "scripts": {
    "build:index": "bunx --bun pagefind --site ./dist --glob \"**/*.html\""
  }
}
```

**å¸¸ç”¨é€‰é¡¹**ï¼š

| é€‰é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
| --- | --- | --- |
| `--site` | æŒ‡å®šç½‘ç«™ç›®å½• | `--site ./dist` |
| `--glob` | è¿‡æ»¤ HTML æ–‡ä»¶ | `--glob "posts/**/*.html"` |
| `--exclude-selectors` | æ’é™¤ CSS é€‰æ‹©å™¨ | `--exclude-selectors ".no-index"` |
| `--force-language` | æŒ‡å®šè¯­è¨€ | `--force-language zh` |

æ›´å¤šé€‰é¡¹è§ [Pagefind CLI æ–‡æ¡£](https://pagefind.app/docs/cli/)ã€‚

### è‡ªå®šä¹‰æœç´¢ UI æ ·å¼

ç¼–è¾‘ `src/components/search/SearchPage.svelte` çš„æ ·å¼ï¼š

```svelte title="src/components/search/SearchPage.svelte"
<style>
  :global(.pagefind-ui__results-area),
  :global(.pagefind-ui__result-link),
  :global(.pagefind-ui__result-excerpt),
  :global(.pagefind-ui__message) {
    color: var(--grey-9) !important;
  }

  .pagefind {
    /* è‡ªå®šä¹‰æœç´¢é¢æ¿æ ·å¼ */
    background: var(--your-color);
    border-radius: 1rem;
    /* ... */
  }
</style>
```

## å¼€å‘ç¯å¢ƒ

### æœ¬åœ°å¼€å‘æ—¶æœç´¢ä¸å¯ç”¨ï¼Ÿ

**åŸå› **ï¼šå¼€å‘æ¨¡å¼ï¼ˆ`bun run dev`ï¼‰ä¸ä¼šç”Ÿæˆ Pagefind ç´¢å¼•ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **æ–¹æ¡ˆ 1**ï¼šæ„å»ºåé¢„è§ˆ
   ```bash
   bun run build
   bun run preview
   ```

2. **æ–¹æ¡ˆ 2**ï¼šä»…ç”Ÿæˆç´¢å¼•ï¼ˆéœ€å…ˆæ„å»ºä¸€æ¬¡ï¼‰
   ```bash
   bun run build:site
   bun run build:index
   bun run preview
   ```

:::note[ä¸ºä»€ä¹ˆå¼€å‘æ¨¡å¼ä¸ç”Ÿæˆç´¢å¼•ï¼Ÿ]
Pagefind éœ€è¦å®Œæ•´çš„ HTML æ–‡ä»¶æ‰èƒ½æå–å†…å®¹ï¼Œè€Œå¼€å‘æ¨¡å¼æ˜¯åŠ¨æ€æ¸²æŸ“çš„ã€‚æ¯æ¬¡ä¿®æ”¹éƒ½é‡æ–°ç”Ÿæˆç´¢å¼•ä¼šä¸¥é‡æ‹–æ…¢å¼€å‘æ•ˆç‡ã€‚
:::

## å¸¸è§é—®é¢˜

### Q: æœç´¢ç»“æœä¸å‡†ç¡®ï¼Ÿ

é‡æ–°ç”Ÿæˆç´¢å¼•ï¼š

```bash
bun run build
```

ç¡®ä¿æ–‡ç« å†…å®¹åŒ…å«åœ¨ `data-pagefind-body` æ ‡è®°çš„å…ƒç´ å†…ã€‚

### Q: æŸäº›æ–‡ç« æœä¸åˆ°ï¼Ÿ

æ£€æŸ¥ï¼š
1. æ–‡ç« æ˜¯å¦è¢«æ­£ç¡®æ„å»ºï¼ˆæŸ¥çœ‹ `dist/` ç›®å½•ï¼‰
2. æ–‡ç« å†…å®¹æ˜¯å¦åœ¨ `data-pagefind-body` èŒƒå›´å†…
3. æ˜¯å¦æœ‰ `data-pagefind-ignore` æ„å¤–æ’é™¤äº†å†…å®¹

### Q: å¦‚ä½•æœç´¢è‰ç¨¿æ–‡ç« ï¼Ÿ

é»˜è®¤æƒ…å†µä¸‹ï¼Œæœªå‘å¸ƒçš„æ–‡ç« ä¸ä¼šè¢«æ„å»ºï¼Œå› æ­¤ä¸ä¼šè¢«ç´¢å¼•ã€‚å¦‚éœ€æœç´¢è‰ç¨¿ï¼Œéœ€è¦å…ˆå°†æ–‡ç« è®¾ç½®ä¸ºå·²å‘å¸ƒçŠ¶æ€ã€‚

### Q: æ”¯æŒä¸­æ–‡åˆ†è¯å—ï¼Ÿ

**æ”¯æŒ**ã€‚Pagefind è‡ªåŠ¨æ£€æµ‹è¯­è¨€å¹¶ä½¿ç”¨å¯¹åº”çš„åˆ†è¯ç­–ç•¥ã€‚ä¸­æ–‡ã€æ—¥æ–‡ç­‰ CJK è¯­è¨€ä¼šä½¿ç”¨ n-gram åˆ†è¯ã€‚

### Q: æœç´¢èƒ½è¯†åˆ«æ‹¼éŸ³å—ï¼Ÿ

**ä¸æ”¯æŒ**ã€‚Pagefind åŸºäºç²¾ç¡®åŒ¹é…å’Œæ¨¡ç³ŠåŒ¹é…ï¼Œä¸æ”¯æŒæ‹¼éŸ³è½¬æ±‰å­—ã€‚

### Q: å¦‚ä½•å®ç°æœç´¢ç»Ÿè®¡ï¼Ÿ

Pagefind æœ¬èº«ä¸æä¾›ç»Ÿè®¡åŠŸèƒ½ã€‚å¦‚éœ€å®ç°ï¼Œå¯ä»¥ï¼š
1. åœ¨æœç´¢ç»„ä»¶ä¸­ç›‘å¬æœç´¢äº‹ä»¶
2. å‘é€ç»Ÿè®¡æ•°æ®åˆ°ç¬¬ä¸‰æ–¹åˆ†ææœåŠ¡ï¼ˆå¦‚ Google Analyticsï¼‰

ç¤ºä¾‹ï¼ˆéœ€ä¿®æ”¹ `SearchPage.svelte`ï¼‰ï¼š

```javascript
new PagefindUI({ 
  element: "#pagefind",
  onSearch: (query) => {
    // ç»Ÿè®¡æœç´¢å…³é”®è¯
    gtag('event', 'search', { search_term: query });
  }
});
```

### Q: èƒ½å¦é›†æˆå…¶ä»–æœç´¢æœåŠ¡ï¼Ÿ

å¯ä»¥ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨ Algoliaã€Meilisearch ç­‰æœåŠ¡ï¼š
1. åˆ é™¤æˆ–æ³¨é‡Š `SearchPage.svelte` ç»„ä»¶
2. é›†æˆå¯¹åº”æœç´¢æœåŠ¡çš„ SDK
3. ä¿®æ”¹å¯¼èˆªæ æœç´¢æŒ‰é’®çš„è§¦å‘é€»è¾‘

ä½†è¿™ä¼šå¤±å» Pagefind çš„ç¦»çº¿å’Œè½»é‡çº§ä¼˜åŠ¿ã€‚

## ç›¸å…³èµ„æº

- [Pagefind å®˜æ–¹æ–‡æ¡£](https://pagefind.app/)
- [Pagefind CLI å‚è€ƒ](https://pagefind.app/docs/cli/)
- [è‡ªå®šä¹‰ Pagefind UI](https://pagefind.app/docs/ui/)
- [Pagefind API æ–‡æ¡£](https://pagefind.app/docs/api/)
